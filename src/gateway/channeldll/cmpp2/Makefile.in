# Makefile.in generated by automake 1.8.5 from Makefile.am.
# diameter/Makefile.  Generated from Makefile.in by configure.

# Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
# 2003, 2004  Free Software Foundation, Inc.
# This Makefile.in is free software; the Free Software Foundation
# gives unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.
VERSION=$(shell svn log -r COMMITTED | grep ^r  | cut -d'|' -f1 | cut -d' ' -f1 | cut -d'r' -f2| head -1)
CXX = @CXX@ -DPROGRAM_REVISION=\"${VERSION}\"
DEFS = @DEFS@
DEFAULT_INCLUDES = -I. 
CPPFLAGS = @CPPFLAGS@
CXXFLAGS = @CXXFLAGS@
ARCHIVE = @ARCHIVE@
AR_FLAGS = @AR_FLAGS@
LIB_SUFFIX=@LIB_SUFFIX@
CXXCOMPILE = $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
	$(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS) 
SHELL = @SHELL@
LIB_CXXFLAGS=@LIB_CXXFLAGS@
LIB_LDFLAGS=@LIB_LDFLAGS@

###################################################################################
#write your own rules here                                                        #
###################################################################################
BIZ=libcmpp2
BIZ_LIB=libcmpp2.so

CMM_DIR=@prefix@/src/gateway/common
CMM_OBJ=$(CMM_DIR)/gateway_util.o \
		$(CMM_DIR)/charset_conv.o \
		$(CMM_DIR)/gateway_crypt.o \
		$(CMM_DIR)/Markup.o		\
		$(CMM_DIR)/channel_db.o

BIZ_OBJ=$(CMM_OBJ) interface.o cmpp2.o 

SRC=$(BIZ_OBJ:.o=.cpp)

EXT_CPPFLAGS = -DBIZDLL\
				-I@prefix@/base \
				-I@prefix@/src/gateway/3rd/include \
				-I@prefix@/src/gateway/channeldll \
				-I@prefix@/src/gateway/common 

EXT_LDFLAGS = -lcrypto -L@prefix@/lib -ltsbase -L@prefix@/src/gateway/3rd/lib -lhiredis -ljsoncpp

$(BIZ_LIB): $(BIZ_OBJ)
	$(CXXCOMPILE) -o $@ $(BIZ_OBJ) $(LIB_LDFLAGS) $(EXT_LDFLAGS)
    
depend: $(SRC)
	makedepend  $(EXT_CPPFLAGS) $(SRC)  2>/dev/null

install: $(BIZ_LIB)
	export SUBVERSION=`svn log -r COMMITTED | grep ^r  | cut -d'|' -f1 | cut -d' ' -f1 | cut -d'r' -f2`;\
	cp -f $(BIZ_LIB) @prefix@/lib/$(BIZ).$$SUBVERSION.so;\
	cd @prefix@/lib;\
	ln -sf $(BIZ).$$SUBVERSION.so $(BIZ_LIB);

clean:
	rm -f $(BIZ_OBJ)
	rm -f $(BIZ_LIB)

include @prefix@/rules.mk
	
